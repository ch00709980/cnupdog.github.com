---
layout: post
title: JAVA调用外部程序，子进程阻塞
category: programming
---  
    使用JAVA的Runtime对象通过exec(cmd)调用远程脚本，随机出现进程hand住的情况。

标准输入输出
--------------
标准流是当一个程序运行后，在程序和它的环境（典型终端），事先连接的输入和输出管道。当然管道的特点是单向的，管道把一个进程的输出传给另一个进程作为输入。
> 在unix环境下执行一个shell命令行通常会自动打开三个标准文件：  
>> **标准输入文件```stdin```:**对应终端的键盘终端     
>> **标准输出文件```stdout```:**对应终端的屏幕     
>> **标准错误输出文件```stderr```:**对应终端的屏幕    



同步异步、阻塞非阻塞
--------------
在通信和I/O中常会提到的两组术语，非常容易混淆，认为他们是一个概念。  
同步和异步是针对信息的发送和接收次序而言，和**消息的通知机制**有关。  
阻塞和非阻塞是针对进程、线程进行等待时的一种方式（是否需要挂起，是否影响线程的执行，是否可以干其他事情），和**程序等待消息时的状态**有关。  
所以它们能有如下四种组合：**同步阻塞**、 **同步非阻塞**、 **异步阻塞**、 **异步非阻塞**。  
> **同步```synchronous```:**发送消息，等待消息处理完后，才往下执行     
> **异步```asynchronous```:**发送消息，不等待消息处理完，就往下执行，让后通过特定的接口或者事件，消息通知你事情完成了  
> **阻塞```blocking```:**程序会阻塞在某一个函数，而不往下执行，就像挂在那里一样，所有的其他业务也都不执行，一直等到有消息到来才往下执行    
> **非阻塞```non-blocking```:**程序不会阻塞在某一个函数，不等待消息到来，往下执行

Process阻塞分析
--------------
**[场景描述]**  现在有很多项目均是前后台结合，前台使用JAVA，后台使用perl或者python等编写的脚本。前台执行动作，然后将操作发送到远程，即执行远程脚本。脚本执行完之后将操作结果返回JAVA，再由其做处理。
以一个执行perl的伪代码描述如下：
    
    String[] cmd = {"/bin/sh","-c",""};//前两个为执行perl必要参数
    cmd2[] = "some comond line";//命令行内容
    Process p = Runtime.getRuntime.exec(cmd);//调用底层linux脚本
    p.waitFor();//控制让当前线程等待，直到Proccess对象表示的进程结束
    
